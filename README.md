# Sistema de An√°lisis Param√©trico OpenSees

[![Tests](https://github.com/GJoe2/opensees-parametric-analysis/actions/workflows/tests.yml/badge.svg)](https://github.com/GJoe2/opensees-parametric-analysis/actions/workflows/tests.yml)
[![Build and Publish](https://github.com/GJoe2/opensees-parametric-analysis/actions/workflows/publish.yml/badge.svg)](https://github.com/GJoe2/opensees-parametric-analysis/actions/workflows/publish.yml)
[![PyPI version](https://badge.fury.io/py/opensees-parametric-analysis.svg)](https://badge.fury.io/py/opensees-parametric-analysis)
[![codecov](https://codecov.io/gh/GJoe2/opensees-parametric-analysis/branch/master/graph/badge.svg)](https://codecov.io/gh/GJoe2/opensees-parametric-analysis)
[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![Python versions](https://img.shields.io/pypi/pyversions/opensees-parametric-analysis.svg)](https://pypi.org/project/opensees-parametric-analysis/)
[![Downloads](https://pepy.tech/badge/opensees-parametric-analysis)](https://pepy.tech/project/opensees-parametric-analysis)
[![GitHub stars](https://img.shields.io/github/stars/GJoe2/opensees-parametric-analysis.svg?style=social&label=Star)](https://github.com/GJoe2/opensees-parametric-analysis)

## üéØ Descripci√≥n General

Sistema completo de an√°lisis param√©trico para estructuras de hormig√≥n armado usando OpenSees. **Nueva arquitectura mejorada** que separa responsabilidades siguiendo principios SOLID, proporcionando mejor mantenibilidad, testabilidad y extensibilidad.

## ‚ú® Caracter√≠sticas Principales

### üèóÔ∏è **Nueva Arquitectura (v2.0)**
- **Domain Objects**: Representaci√≥n orientada a objetos de conceptos estructurales
- **Specialized Builders**: Constructores especializados con responsabilidad √∫nica
- **Improved ModelBuilder**: Orquestador que usa builders especializados
- **Better API**: Interfaz m√°s intuitiva y expresiva

### üîß **Funcionalidades T√©cnicas**
- **Geometr√≠a**: Estructuras rectangulares con relaci√≥n L/B variable
- **Elementos**: Columnas 40x40 cm, vigas 25x40 cm, losa de 10 cm  
- **Pisos**: 2 pisos de 3 m cada uno (configurable)
- **An√°lisis**: Est√°tico, modal y din√°mico con par√°metros personalizables
- **Visualizaci√≥n**: Control granular con opstool
- **Post-procesamiento**: Reportes autom√°ticos y visualizaciones interactivas

### üéØ **Ventajas de la Nueva Arquitectura**
- **Separaci√≥n de responsabilidades**: Cada clase tiene una sola responsabilidad
- **Mejor testabilidad**: Tests unitarios independientes para cada componente
- **Reutilizaci√≥n**: Builders pueden usarse en diferentes contextos
- **Extensibilidad**: F√°cil adici√≥n de nuevos tipos de an√°lisis o elementos
- **Mantenibilidad**: Cambios aislados que no afectan otros componentes
## üöÄ Inicio R√°pido

### Instalaci√≥n
```bash
# Opci√≥n 1: Desde PyPI (cuando est√© publicado)
pip install opensees-parametric-analysis

# Opci√≥n 2: Desde c√≥digo fuente
git clone https://github.com/GJoe2/opensees-parametric-analysis.git
cd opensees-parametric-analysis
pip install -r requirements.txt

# Opci√≥n 3: Instalaci√≥n autom√°tica en Linux (detecta entorno)
curl -fsSL https://raw.githubusercontent.com/GJoe2/opensees-parametric-analysis/master/scripts/install.sh | bash
```

**Requisitos:** 
- Python 3.12+ (requerido por openseespy y opstool)
- **Linux Desktop**: Dependencias b√°sicas
  ```bash
  sudo apt-get install -y libopenblas-dev liblapack-dev libblas-dev gfortran
  ```
- **Linux Server**: Dependencias b√°sicas + gr√°ficas para headless
  ```bash
  sudo apt-get install -y libopenblas-dev liblapack-dev libblas-dev gfortran libglu1-mesa-dev xvfb
  ```

üìã **Instalaci√≥n completa**: Ver [requisitos del sistema](docs/system-requirements.md)

### Uso B√°sico - Nueva Arquitectura (Recomendado)

```python
# Nueva arquitectura mejorada (v2.0)
from src.model_builder_v2 import ModelBuilder
from src.analysis_engine import AnalysisEngine

# Crear modelo con la nueva arquitectura
builder = ModelBuilder(output_dir="models")
model = builder.create_model(
    L_B_ratio=1.5, 
    B=10.0, 
    nx=4, 
    ny=4,
    enabled_analyses=['static', 'modal', 'dynamic'],
    analysis_params={
        'modal': {'num_modes': 10},
        'visualization': {'enabled': True}
    }
)

# El modelo ahora es un objeto rico con m√©todos √∫tiles
print(f"Modelo: {model.name}")
print(f"Dimensiones: {model.geometry.L}x{model.geometry.B}m")
print(f"√Årea: {model.geometry.get_footprint_area():.1f} m¬≤")
print(f"Altura total: {model.geometry.get_total_height():.1f} m")

# Analizar usando domain objects
boundary_nodes = model.geometry.get_boundary_nodes()
total_load = model.loads.get_total_vertical_load()
print(f"Nodos de contorno: {len(boundary_nodes)}")
print(f"Carga total: {total_load:.1f} tonf")

# An√°lisis
engine = AnalysisEngine()
results = engine.analyze_model(model.to_dict())
```

### Uso con Arquitectura Anterior (Compatibilidad)

```python
# Arquitectura anterior (mantenida para compatibilidad)
from src.model_builder import ModelBuilder
from src.analysis_engine import AnalysisEngine

# Crear y analizar modelo
builder = ModelBuilder()
model = builder.create_model(L_B_ratio=1.5, B=10, nx=4, ny=4)

engine = AnalysisEngine()
results = engine.analyze_model(model['file_path'])

print(f"Periodo fundamental: {results['modal_analysis']['fundamental_period']:.4f} s")
```

### Estudio Param√©trico
```python
# Si instalaste desde PyPI
from opensees_parametric_analysis import ParametricRunner

# Si usas c√≥digo fuente  
from src.parametric_runner import ParametricRunner

# Configurar estudio
runner = ParametricRunner(builder, engine)
results = runner.run_full_study(
    L_B_ratios=[1.5, 2.0], 
    B_values=[10.0, 15.0],
    nx_values=[3, 4], 
    ny_values=[3, 4]
)

print(f"Modelos analizados: {len(results)}")
```

## üèóÔ∏è Nueva Arquitectura (v2.0)

### Conceptos Clave

La nueva arquitectura separa las responsabilidades en diferentes tipos de objetos:

#### **Domain Objects** (Objetos de Dominio)
Representan conceptos del mundo real de la ingenier√≠a estructural:

```python
from src.domain import StructuralModel, Geometry, Loads, AnalysisConfig

# Los objetos de dominio tienen m√©todos √∫tiles
geometry = model.geometry
print(f"√Årea de planta: {geometry.get_footprint_area():.1f} m¬≤")
print(f"Relaci√≥n de aspecto: {geometry.get_aspect_ratio():.2f}")

# Consultas espec√≠ficas
boundary_nodes = geometry.get_boundary_nodes(floor=0)
columns = geometry.get_elements_by_type('column')
top_floor_nodes = geometry.get_floor_nodes(geometry.num_floors)
```

#### **Specialized Builders** (Constructores Especializados)
Cada builder tiene una sola responsabilidad:

```python
from src.builders import GeometryBuilder, SectionsBuilder, LoadsBuilder

# Crear geometr√≠a personalizada
custom_geometry = GeometryBuilder.create(
    L_B_ratio=2.0, B=12.0, nx=5, ny=4,
    num_floors=3,        # 3 pisos en lugar de 2
    floor_height=3.5     # 3.5m en lugar de 3.0m
)

# Crear secciones personalizadas
custom_sections = SectionsBuilder.create({
    'column_size': (0.50, 0.50),    # Columnas m√°s grandes
    'beam_size': (0.30, 0.50),      # Vigas m√°s grandes
    'slab_thickness': 0.15          # Losa m√°s gruesa
})
```

### Ventajas de la Nueva Arquitectura

- **üéØ Responsabilidad √∫nica**: Cada clase tiene una sola raz√≥n para cambiar
- **üß™ Mejor testabilidad**: Tests unitarios independientes
- **üîÑ Reutilizaci√≥n**: Componentes reutilizables en diferentes contextos
- **üìù Mantenibilidad**: C√≥digo m√°s organizado y f√°cil de mantener
- **üöÄ Extensibilidad**: F√°cil adici√≥n de nuevas funcionalidades

### Migraci√≥n Gradual

Ambas arquitecturas coexisten para permitir migraci√≥n gradual:

```python
# Script de migraci√≥n y comparaci√≥n
python scripts/migration_test.py

# Ejemplos con nueva arquitectura
python examples/new_architecture_demo.py
```

### Documentaci√≥n Detallada

- **[Nueva Arquitectura](docs/new-architecture.md)**: Gu√≠a completa de la nueva arquitectura
- **[Migraci√≥n](scripts/migration_test.py)**: Script para migrar gradualmente
- **[Ejemplos](examples/new_architecture_demo.py)**: Ejemplos pr√°cticos

### üéØ Ejemplos Completos
Para casos de uso espec√≠ficos y ejemplos detallados, consulte la carpeta [`examples/`](examples/) y la [gu√≠a completa](examples/GUIA_EJEMPLOS.md):

| Ejemplo | Descripci√≥n | Nivel |
|---------|-------------|-------|
| [01_analisis_individual_basico.py](examples/01_analisis_individual_basico.py) | An√°lisis de un modelo individual | Principiante |
| [02_control_visualizacion.py](examples/02_control_visualizacion.py) | Control granular de visualizaci√≥n | Intermedio |
| [03_tipos_analisis.py](examples/03_tipos_analisis.py) | Diferentes tipos de an√°lisis | Intermedio |
| [04_estudio_parametrico.py](examples/04_estudio_parametrico.py) | Estudios param√©tricos completos | Avanzado |
| [05_exportacion_scripts.py](examples/05_exportacion_scripts.py) | Exportaci√≥n de scripts Python | Intermedio |
| [06_generacion_reportes.py](examples/06_generacion_reportes.py) | Generaci√≥n de reportes | Avanzado |
## üèóÔ∏è Arquitectura

### Estructura Modular
```
src/
‚îú‚îÄ‚îÄ model_builder.py          # Constructor de modelos (API unificada)
‚îú‚îÄ‚îÄ analysis_engine.py        # Motor de an√°lisis (refactorizado)
‚îú‚îÄ‚îÄ parametric_runner.py      # Orquestador de estudios
‚îú‚îÄ‚îÄ python_exporter.py        # Exportador de scripts
‚îú‚îÄ‚îÄ report_generator.py       # Generador de reportes
‚îî‚îÄ‚îÄ utils/                    # Utilidades modulares
    ‚îú‚îÄ‚îÄ analysis_types.py      # An√°lisis espec√≠ficos
    ‚îú‚îÄ‚îÄ visualization_helper.py # Helper de visualizaci√≥n
    ‚îî‚îÄ‚îÄ model_helpers.py       # M√©todos de conveniencia
```

### Componentes Principales

| Componente | Funci√≥n | Entrada | Salida |
|------------|---------|---------|--------|
| **ModelBuilder** | Creaci√≥n de modelos | Par√°metros geom√©tricos | JSON con modelo + configuraci√≥n |
| **AnalysisEngine** | Ejecuci√≥n de an√°lisis | JSON de modelo | Resultados + visualizaciones |
| **ParametricRunner** | Estudios param√©tricos | Rangos de par√°metros | Resultados m√∫ltiples |

## üìä Control de Visualizaci√≥n

### Configuraci√≥n Granular
```python
# Solo n√∫meros (m√°xima velocidad)
model = builder.create_model(1.5, 10, 4, 4,
    analysis_params={'visualization': {'enabled': False}}
)

# Solo deformada est√°tica
model = builder.create_model(1.5, 10, 4, 4,
    analysis_params={
        'visualization': {
            'enabled': True,
            'static_deformed': True,
            'modal_shapes': False
        }
    }
)

# Presentaci√≥n completa
model = builder.create_model(1.5, 10, 4, 4,
    analysis_params={
        'visualization': {
            'enabled': True,
            'static_deformed': True,
            'modal_shapes': True,
            'max_modes': 6,
            'deform_scale': 200
        }
    }
)
```

## üß™ Testing

### Ejecutar Tests
```bash
# Runner interactivo
python tests/run_all_tests.py

# Con pytest (recomendado)
pip install pytest
pytest tests/ -v

# Tests espec√≠ficos
python tests/run_all_tests.py 1  # Solo ModelBuilder
```

## üìö Documentaci√≥n Detallada

Para informaci√≥n completa y detallada, consulte la documentaci√≥n organizada en la carpeta [`docs/`](docs/):

### üéØ Por Audiencia

#### Para Usuarios Nuevos
- [**üìã √çndice General**](docs/index.md) - Navegaci√≥n completa
- [**üîß Instalaci√≥n**](docs/installation.md) - Setup completo y dependencias  
- [**üöÄ Gu√≠a de Uso**](docs/usage.md) - Ejemplos y API detallada

#### Para Desarrolladores  
- [**üèóÔ∏è Arquitectura**](docs/architecture.md) - Dise√±o del sistema y componentes
- [**üß™ Testing**](docs/testing.md) - Suite de tests y validaci√≥n
- [**üêõ Troubleshooting**](docs/troubleshooting.md) - Soluci√≥n de problemas

#### Para Investigadores
- [**üìä Par√°metros del Modelo**](docs/model-parameters.md) - Configuraci√≥n y nomenclatura
- [**üéõÔ∏è Control de Visualizaci√≥n**](docs/visualization.md) - Configuraci√≥n granular
- [**üöÄ Uso Avanzado**](docs/usage.md#estudios-param√©tricos) - Estudios param√©tricos

### üîç Por Tema Espec√≠fico

| Tema | Documento | Descripci√≥n |
|------|-----------|-------------|
| **Instalaci√≥n** | [installation.md](docs/installation.md) | Setup, dependencias, configuraci√≥n |
| **Requisitos** | [system-requirements.md](docs/system-requirements.md) | Requisitos del sistema y troubleshooting |
| **Uso B√°sico** | [usage.md](docs/usage.md) | API, ejemplos, casos de uso |
| **Arquitectura** | [architecture.md](docs/architecture.md) | Dise√±o, componentes, extensibilidad |
| **Par√°metros** | [model-parameters.md](docs/model-parameters.md) | Configuraci√≥n del modelo, nomenclatura |
| **Visualizaci√≥n** | [visualization.md](docs/visualization.md) | Control granular, optimizaci√≥n |
| **Testing** | [testing.md](docs/testing.md) | Suite de tests, validaci√≥n |
| **Problemas** | [troubleshooting.md](docs/troubleshooting.md) | Debugging, soluciones comunes |

## üìÅ Estructura del Proyecto

```
opensees-parametric-analysis/
‚îú‚îÄ‚îÄ src/                      # C√≥digo fuente
‚îú‚îÄ‚îÄ docs/                     # Documentaci√≥n detallada
‚îú‚îÄ‚îÄ examples/                 # Ejemplos de uso pr√°cticos
‚îú‚îÄ‚îÄ notebooks/                # Jupyter notebooks
‚îú‚îÄ‚îÄ models/                   # Modelos generados
‚îú‚îÄ‚îÄ results/                  # Resultados de an√°lisis
‚îú‚îÄ‚îÄ tests/                    # Suite de tests
‚îú‚îÄ‚îÄ requirements.txt          # Dependencias
‚îî‚îÄ‚îÄ README.md                # Este archivo
```

## ÔøΩ Beneficios de la Refactorizaci√≥n

- ‚úÖ **C√≥digo 50% m√°s corto y legible**
- ‚úÖ **Eliminaci√≥n del 80% de condicionales complejas**
- ‚úÖ **Separaci√≥n clara de responsabilidades**
- ‚úÖ **Gesti√≥n inteligente de recursos**
- ‚úÖ **API unificada y consistente**
- ‚úÖ **Control granular de visualizaci√≥n**
- ‚úÖ **Suite de tests completa**

## üìú Licencia

Este proyecto est√° bajo licencia Apache 2.0. Ver archivo LICENSE para m√°s detalles.

## üìû Contacto

Para preguntas, soporte o contribuciones:
- **Issues**: [GitHub Issues](https://github.com/GJoe2/opensees-parametric-analysis/issues)
- **Documentaci√≥n**: [docs/](docs/)

---

**üí° Tip**: Para empezar r√°pidamente, revise el [√≠ndice de documentaci√≥n](docs/index.md) y seleccione la gu√≠a apropiada para su caso de uso. 